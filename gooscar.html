<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>购物车</title>
		<link rel="stylesheet" href="css/goodscars.css">
		<link rel="stylesheet" href="css/header.css">
		<link rel="stylesheet" href="css/common.css">
	</head>
	<body>

		<div id="header">
			<div id="header_top">
				<div id="header_left">
					<a href="">查找专柜</a>
					<a href="">美颜中心</a>
					<a href="">选择娇韵诗</a>
					<a href="">服务与帮助</a>
				</div>
				<div id="logo"><img src="img/46c041b.jpg" alt=""></div>
				<div id="header_right">
					<div id="header_search">
						<input type="text" value="黄金双萃">
						<img src="img/search.png" alt="">
					</div>
					<div id="header_center">
						<img src="img/7ced9ee.png" alt="">
						<a href="">登录</a>
					</div>
					<div id="header_good">
						<img src="img/cart.png" alt="">
					</div>
				</div>
			</div>
		</div>
		<!-- height2	 -->
		<div id="headers">
			<div id="header_buttom">
				<a href="">首页</a>
				<a class="mianbu" href="" style="display: inline-block;">面部护理</a>

				<a href="">身体护理</a>
				<a href="">准妈妈系列</a>
				<a href="">彩妆系列</a>
				<a href="">男士系列</a>
				<a href="">礼品及套装</a>
				<a href="">特别活动</a>
				<a href="">明星商品</a>
				
				<a class="hui" href="">会员俱乐部</a>
				<a class="hui" href="">美妆学院</a>
				<a class="hui" href="">CLARINS MAG</a>
				<div id="js">
					<a href="" class="duo">更多<img src="" alt=""></a>
						<div id="mag">
							
							<p>会员俱乐部</p>
							<p>美妆学院</p>
							<p>CLARINS MAG</p>
							
						</div>
					
				</div>
				
				<div id="header_right" class="right">
					<div id="header_search">
						<input type="text" placeholder="黄金双萃">
						<img src="img/search.png" alt="">
					</div>
					<div id="header_center">
						<img src="img/f965d63.png" alt="" class="png">
					</div>
					<div id="header_good">
						<img src="img/94ca68a.png" alt="">
					</div>
				</div>

			</div>
			<div id="slip" style="display: none;">
				<div id="slips">
					<div id="slipser">
						<ul>
							<li><a href="">产品类型</a></li>
							<li><a href="">清洁卸妆</a></li>
							<li><a href="">化妆水/精华水</a></li>
							<li><a href="">卓效精华</a></li>
							<li><a href="">眼部护理</a></li>
							<li><a href="">面霜/护理油</a></li>
							<li><a href="">唇部颈部护理</a></li>
							<li><a href="">面部</a></li>
							<li><a href="">防晒隔离</a></li>
						</ul>
						<ul>
							<li><a href="">选择系列</a></li>
							<li><a href="">抗老·黄金赋活系列</a></li>
							<li><a href="">抗老·青春赋活系列</a></li>
							<li><a href="">抗老·焕颜弹力系列</a></li>
							<li><a href="">抗老·花样年华系列</a></li>
							<li><a href="">塑颜紧致</a></li>
							<li><a href="">清透润白</a></li>
							<li><a href="">基础清洁</a></li>
							<li><a href="">沁润保湿</a></li>
							<li><a href="">清透防晒</a></li>
							<li><a href="">清爽雅致</a></li>
						</ul>
						<ul>
							<li><a href="">美肌需求</a></li>
							<li><a href="">抗老赋活</a></li>
							<li><a href="">淡斑亮白</a></li>
							<li><a href="">提拉V脸</a></li>
							<li><a href="">补水保湿</a></li>
							<li><a href="">控油/缩毛孔</a></li>
							<li><a href="">滋润舒缓</a></li>
							<li><a href="">防晒隔离</a></li>
						</ul>
					</div>
					<div id="slipsers">
						<ul>
							<a href="">
								<img src="img/fbe90ab.jpg" alt="">
								<p>抗老复活系列</p>
								<p>明星御领 焕活年轻</p>
								<img src="img/lj.jpg" alt="">
							</a>
						</ul>

						<ul>
							<a href="">
								<img src="img/fbe90ab.jpg" alt="">
								<p>抗老复活系列</p>
								<p>明星御领 焕活年轻</p>
								<img src="img/lj.jpg" alt="">
							</a>
						</ul>
					</div>

				</div>


			</div>
		</div>

		<!-- 我的购物车 -->
		<!-- <div class="goodsCar">
			<div id="goodsCar2">
				<p>我的购物车</p>
				<img src="goddsCarimg/progress.png" alt="">
			</div>
		</div> -->

		<!-- 商品信息 -->
		<!-- <div class="goodsCar">
			<div id="goodsNew">
				<div class="news">商品信息</div>
				<div class="prices">单价</div>
				<div class="num">数量</div>
				<div class="xiaoji">小计</div>
				<div class="caoz">操作</div>
			</div>
		</div> -->
		<!-- 购物栏 -->
		<!-- <div class="goodsCar">
			<div id="goodsShop">
				<div class="goodsShop-L">
					<div class="news-x">
						<div class="newsL">
							<img src="goddsCarimg/img_dsc_rx100m7_vct_sgr1_191204.jpg" alt="">
						</div>
						<div class="newsR">
							DSC-RX100M7G 黑卡®数码相机 手柄套装（24-200mm蔡司镜头 实时眼部对焦 4K HDR 视频拍摄 RX100 VII）
						</div>
					</div>
					<div class="prices-x">RMB 8,899.00</div>
					<div class="num-x">
						<div class="spriceGE-pD2">
							<div class="divSpan">-</div>
							<span class="divSpan goods-num">0</span>
							<div class="divSpan">+</div>
						</div>
					</div>
					<div class="xiaoji-x">
						<div class="prices-x">RMB 8,899.00</div>
					</div>
					<div class="caoz-x">
						<a href="" class="caoz-xa">移入心愿单</a>
						<img src="goddsCarimg/cp_del.png" alt="">
						<a href="" class="caoz-xs">删除</a>
						
					</div>
				</div>
			</div>
			
		</div> -->

		<!-- 关注我们 -->
		<!-- <div class="goodsCar wzJS1">
			<div id="wzJS">
				
				<div id="wzJSB">
					<div id="wzJSBX">
						<div id="rmb">总价:RMB<span>0.00</span></div>
						<div id="pricejs">去结算(<span>0</span>)</div>
					</div>
				</div>
			</div>
			
		</div> -->
		<!-- 正文 -->
		<div id="cars">
			<div id="car">
				<h2>购物车<span>（<span id="liangs">0</span>）</span></h2>
			</div>
		</div>

		<div id="goods">
			<div id="goodscar">

				<!-- 左边 -->
				<div id="car_left">
					<table id="tabl" border="0" cellpadding="0" cellspacing="0">
						<!-- <tr id="one">
							<td class="xin">商品信息</td>
							<td>商品单价</td>
							<td>数量</td>
							<td>小计</td>
							<td>操作</td>
						</tr> -->
						<!-- 重点 -->
						<!-- <tr id="two" >
							<td>
								<div id="inp">
									<input type="checkbox" class="inpus">
								</div>
								<div id="im">
									<img src="img/0898c2d.jpg" alt="">
								</div>
								<div id="pp">
									<p>面部护理</p>
									<p>保湿焕采面膜</p>
									<p>密集保湿，柔嫩肌肤</p>
								</div>
							</td>
							<td id="danjia">￥<span>380</span></td>
							<td>
								<div id="btn">
									<button>-</button>
									<span class="shuliang">1</span>
									<button>+</button>
								</div>
							</td>
							<td id="xiaoji" class="xiaoji">￥<span>380</span></td>
							<td><span id="shanchu" class="shanchu">删除</span></td>
						</tr>
						
						<tr id="two" >
							<td>
								<div id="inp">
									<input type="checkbox">
								</div>
								<div id="im">
									<img src="img/0898c2d.jpg" alt="">
								</div>
								<div id="pp">
									<p>面部护理</p>
									<p>保湿焕采面膜</p>
									<p>密集保湿，柔嫩肌肤</p>
								</div>
							</td>
							<td id="danjia">￥<span>380</span></td>
							<td>
								<div id="btn">
									<button>-</button>
									<span class="shuliang">1</span>
									<button>+</button>
								</div>
							</td>
							<td id="xiaoji" class="xiaoji">￥<span>380</span></td>
							<td><span id="shanchu" class="shanchu">删除</span></td>
						</tr> -->
						<!-- <tr id="three">
							<td colspan="5" >
								<div id="liwu">
									<div id="de">
										<img src="img/03e30e1.jpg" alt="">
										<p>我的试用（0/3）</p>
									</div>
									<div id="go">
										<a href="">去选择></a>
									</div>
								</div>
							</td>
						</tr>
						<tr id="four">
							<td colspan="5">
								<div id="jiesuan">
									<p>已选商品<span>0</span>件，总价￥<span>0</span></p>
									<a href="#" >下单结算</a>
								</div>
							</td>
						</tr> -->
					</table>
				</div>


				<!-- 右边 -->
				<div id="car_right">
					<p id="suan">订单结算</p>
					<div id="quan">
						<p>优惠券代码</p>
						<div id="ying">
							<input type="text" id="yong" value="请输入优惠码">
							<a href="">应用</a>
						</div>
						<p id="youhui">暂无可用优惠券</p>
					</div>
					<div class="jiag top">
						<p>商家价格</p>
						<span>￥<span id="moneyes">0</span></span>
					</div>
					<div class="jiag bottom">
						<p>优惠金额</p>
						<span>￥0</span>
					</div>
					<div id="money">
						总价<span>￥<span id="moneys">0</span></span>
					</div>
					<a href="" id="xd">下单结算</a>
				</div>

			</div>
		</div>

		<!-- 底部 -->
		<div id="message">
			<div id="messages">
				<div class="bannert_a">
					<img src="img/ding.jpg">
					<p>订阅娇韵诗最新资讯和活动信息</p>
					<img src="img/ding.jpg">
				</div>
				<div id="information">
					<div id="informations">
						<input type="email" placeholder="*请输入您的Email地址">
						<input type="number" placeholder="*请输入您的手机号">
						<input type="text" placeholder="*姓名">
					</div>
					<div id="select">
						<p>出生日期</p>
						<select>
							<option value="">年</option>
							<option value="2020">2020</option>
							<option value="2019">2019</option>
							<option value="2018">2018</option>
							<option value="2017">2017</option>
							<option value="2016">2016</option>
						</select>
						<select name="" id="">
							<option value="0">月</option>
						</select>
						<select name="" id="">
							<option value="0">日</option>
						</select>
					</div>

				</div>
				<div id="ding">
					<p><a href="">订阅</a></p>
				</div>
			</div>
		</div>

		<!-- /* 灰色的盒子  底部 */ -->
		<div id="footer">
			<div id="footers">
				<div class="bannert_a bannert_f">
					<img src="img/foot.jpg" alt="">
					<p>官网独享</p>
					<img src="img/foot.jpg" alt="">
				</div>

				<div id="alone">
					<div id="alones">
						<a href="">
							<img src="img/cb941a2.jpg" alt="">
							<p class="p1">实付588包邮</p>
							<p class="p2">购任意正装即享</p>
						</a>
					</div>

					<div id="alones">
						<a href="">
							<img src="img/5d2020f.jpg" alt="">
							<p class="p1">免费试用</p>
							<p class="p2">买即送3件明星试用装</p>
						</a>
					</div>
					<div id="alones">
						<a href="">
							<img src="img/03e30e1.jpg" alt="">
							<p class="p1">特别活动</p>
							<p class="p2">特别活动</p>
						</a>
					</div>
					<div id="alones">
						<a href="">
							<img src="img/0569c79.jpg" alt="">
							<p class="p1">会员俱乐部</p>
							<p class="p2">积分兑换明星好礼</p>
						</a>
					</div>
					<div id="alones">
						<a href="">
							<img src="img/3c363b1.jpg" alt="">
							<p class="p1">礼物包装</p>
							<p class="p2">购买即送礼物包装盒</p>
						</a>
					</div>
					<div id="alones">
						<a href="">
							<img src="img/d3e9e71.jpg" alt="">
							<p class="p1">联系我们</p>
							<p class="p2">400-690-0626<br>
								周一至周五 9:00-21:00<br>
								周六至周日 9:00-18:00</p>
						</a>
					</div>
				</div>

				<div id="pay">
					<div id="pays">
						<a href="">
							<img src="img/14b9594.jpg" alt="">
						</a>
						<a href="">
							<img src="img/df178c2.jpg" alt="">
						</a>
						<a href="">
							<img src="img/393bef2.jpg" alt="">
						</a>
					</div>
				</div>

				<div id="foot">
					<div id="foot_l">
						<div id="footst">
							<div class="foott">
								<p>类别1</p>
								<ul>
									<li><a href="">面部护理</a></li>
									<li><a href="">身体护理</a></li>
									<li><a href="">彩妆系列</a></li>
									<li><a href="">男士系列</a></li>
									<li><a href="">礼品及套装</a></li>
									<li><a href="">特别活动</a></li>

								</ul>
							</div>
							<div class="foott">
								<p>类别2</p>
								<ul>
									<li><a href="">面部护理</a></li>
									<li><a href="">身体护理</a></li>
									<li><a href="">彩妆系列</a></li>
									<li><a href="">男士系列</a></li>
									<li><a href="">礼品及套装</a></li>
								</ul>
							</div>
							<div class="foott">
								<p>类别3</p>
								<ul>
									<li><a href="">面部护理</a></li>
									<li><a href="">身体护理</a></li>
									<li><a href="">彩妆系列</a></li>
									<li><a href="">男士系列</a></li>
								</ul>
							</div>
						</div>

						<div id="footss">
							<div class="foott">
								<p>类别4</p>
								<ul>
									<li><a href="">面部护理</a></li>
									<li><a href="">身体护理</a></li>
									<li><a href="">彩妆系列</a></li>
									<li><a href="">男士系列</a></li>
									<li><a href="">礼品及套装</a></li>
									<li><a href="">特别活动</a></li>
									<li><a href="">特别活动</a></li>
								</ul>
							</div>
							<div class="foott">
								<p>类别5</p>
								<ul>
									<li><a href="">面部护理</a></li>
									<li><a href="">身体护理</a></li>
									<li><a href="">彩妆系列</a></li>
									<li><a href="">男士系列</a></li>
								</ul>
							</div>
							<div class="foott">
								<p>类别6</p>
								<ul>
									<li><a href="">面部护理</a></li>
									<li><a href="">身体护理</a></li>
									<li><a href="">彩妆系列</a></li>
									<li><a href="">男士系列</a></li>
								</ul>
							</div>
						</div>



					</div>
					<div id="foot_r">
						<p>关注娇韵诗微信公众号</p>
						<img src="img/fd62bbf.jpg" alt="">
						<p>娇韵诗国际官网</p>
						<select name="" id="">
							<option value="0">CLARINS 中国</option>
						</select>
					</div>
				</div>

				<div id="bei">
					<p>
						<a href="">一般销售条款&nbsp;|&nbsp;</a>
						<a href="">隐私政策 &copy; 娇韵诗化妆品（上海）有限公司版权所有&nbsp;|&nbsp;</a>
						<a href="">
							<img src="img/efc1522.jpg">
							<!-- &nbsp; -->
							<a href="">沪ICP备13011137号-1</a>
						</a>
					</p>
					<p>国家药监局提示您：请正确认识化妆品功效，化妆品不能替代药品，不能治疗皮肤病等疾病。</p>

				</div>

			</div>
		</div>
		<div id="footer_guding">
			<div id="footers_guding">
				<div id="liaojie">
					<img src="img/1152b5c.png" alt="">
					<a href=""> <marquee  direction="滚动方向">即日起，全场购正装即享双倍积分。官网已陆续进行发货（湖北地区因物流停运除外），由于受管控影响，发货与包裹配送时效可能会存在延迟，还望您耐心等待。</marquee></a>
					<a href="">了解详情></a>
				</div>
				<div id="focus">
					<a href=""><img src="img/5323624.png" alt=""><span>在线咨询</span></a>
					<a href=""><img src="img/117dd6a.png" alt=""></a>
					<a href=""><img src="img/68243b1.png" alt=""></a>
					<p>关注我们</p>
				</div>
			</div>
		</div>
		<!-- //返回顶部 -->
		<div id="yuan_top"><img src="img/zk.png" alt=""></div>
	</body>
</html>
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/headers.js"></script>
<!-- <script src="js/goodscar.js"></script> -->
<script src="js/common.js"></script>
<script src="js/cookieTools.js"></script>
<script type="text/javascript">
	$(".mianbu").mouseover(function() {
		$("#slip").css({
			"display": "block"
		})
	})
	$(".mianbu").mouseout(function() {
		$("#slip").css({
			"display": "none"
		})
	})
	$("#slip").mousemove(function() {
		$(this).css({
			"display": "block"
		})
	})
	$("#slip").mouseout(function() {
		$(this).css({
			"display": "none"
		})
	})
	
	$(function(){
		let nume=getCookie("username")
		$.get(
			"getShoppingCart.php",
			{
				vipName:nume,
			},
			function(obj){
				let arr=JSON.parse(obj);
				let htmlStr=`
					<tr id="one">
						<td class="xin">商品信息</td>
						<td>商品单价</td>
						<td>数量</td>
						<td>小计</td>
						<td>操作</td>
					</tr>
				`;
					
				arr.forEach(function(arr){
					let currmoney = arr.goodsPrice*arr.goodsCount;
				     htmlStr += `
							<tr id="two" >
								<td>
									<div id="inp">
										<input type="checkbox" class="inpus">
									</div>
									<div id="im">
										<img src="${arr.goodsImg}" alt="">
									</div>
									<div id="pp">
										<p>${arr.beiyong2}</p>
										<p>${arr.goodsName}</p>
										<p>${arr.goodsDesc}</p>
									</div>
								</td>
								<td id="danjia">￥<span>${arr.goodsPrice}</span></td>
								<td>
									<div id="btn">
										<button>-</button>
										<span class="shuliang">${arr.goodsCount}</span>
										<button>+</button>
									</div>
								</td>
								<td id="xiaoji" class="xiaoji">￥<span>${currmoney}</span></td>
								<td><span id="shanchu" class="shanchu">删除 <span style="display:none;">${arr.goodsId}</span> </span></td>
							</tr>
				     `;
				})
					htmlStr+=`
						<tr id="three">
							<td colspan="5" >
								<div id="liwu">
									<div id="de">
										<img src="img/03e30e1.jpg" alt="">
										<p>我的试用（0/3）</p>
									</div>
									<div id="go">
										<a href="">去选择></a>
									</div>
								</div>
							</td>
						</tr>
						<tr id="four">
							<td colspan="5">
								<div id="jiesuan">
									<p>已选商品<span id="vie">0</span>件，总价￥<span id="hre">0</span></p>
									<a href="#" >下单结算</a>
								</div>
							</td>
						</tr>
					`;
				
				
				 $("#tabl").html(htmlStr);
				 
				
			}).then(function() {
				fun();
				cli();
				nums();
			})
			
			//点击input时
			function cli(){
				$("input").click(function(){
					money();
					num();
				})
			}
			
			
			// 增加
			function adds(btn){
				let count=btn.previousElementSibling.innerHTML;
				count++;
				btn.previousElementSibling.innerHTML=count;
				//小计
				let price=+ btn.parentNode.parentNode.previousElementSibling.childNodes[1].innerHTML;
				// let price=document.getElementById("xiaoji").innerHTML;
				let Money=count*price;
				btn.parentNode.parentNode.nextElementSibling.childNodes[1].innerHTML=Money;
				//共计
				money();
				num();	
			}
			
			//减少
			function deletes(btn){
				let count=btn.nextElementSibling.innerHTML;
				count--;
				btn.nextElementSibling.innerHTML=count;
				//小计
				let price=+btn.parentNode.parentNode.previousElementSibling.childNodes[1].innerHTML;
				let Money=count*price;
				btn.parentNode.parentNode.nextElementSibling.childNodes[1].innerHTML=Money;
				//共计
				money();
				num();
			}
			
			//删除
			function dels(btn){
				btn.parentNode.parentNode.remove();
				money();
				num();
				
				
			}
			
			//删除
			function dels(btn){
			    if(confirm("亲，您确定要删除吗？")){
			        //先发送后端的请求，把后端的数据改了
			        //调用接口文档中删除购物车  deleteGoods.php
					$.get(
						"deleteGoods.php",
						{
							"vipName":nume,
							"goodsId":$("#shanchu").children("span").text()
						},
						function(obj){
							if(obj==1){
						//再删除前端
								btn.parentNode.parentNode.remove();
								money();
								num();
								alert("删除成功");
							}else{
								alert("删除失败");
							}
						}
						
						)
			       
			      
			    }
			}
			
			// 共计
				function money(){
					let inpus=document.getElementsByClassName("inpus");
					let xjs=0;
					for(let i=0;i<inpus.length;i++){
						if(inpus[i].checked==true){
							let xj=document.getElementsByClassName("xiaoji");		
							
							// for(let i=0;i<xj.length;i++){
								xjs+= parseInt(xj[i].childNodes[1].innerHTML) ;
							// }
							let table=document.getElementsByTagName("table")[0];
							table.rows[table.rows.length-1].cells[0].firstElementChild.childNodes[1].childNodes[3].innerHTML=xjs;
							$("#moneys").html(xjs);
							$("#moneyes").html(xjs);
						}
					
					}
				
				}
				
				//件数
				function num(){
					let shuliang=document.getElementsByClassName("shuliang");		
					let inpus=document.getElementsByClassName("inpus");
					let sls=0;
					for(let i=0;i<shuliang.length;i++){
						if(inpus[i].checked){
							sls=+shuliang[i].innerHTML + sls;
							let table=document.getElementsByTagName("table")[0];
							table.rows[table.rows.length-1].cells[0].firstElementChild.childNodes[1].childNodes[1].innerHTML=sls;
							
						}
					}
				}
				//我的购物车
				function nums(){
					let shuliang=document.getElementsByClassName("shuliang");	
					let sls=0;
					for(let i=0;i<shuliang.length;i++){
							sls=+shuliang[i].innerHTML + sls;
							// let table=document.getElementsByTagName("table")[0];
							// table.rows[table.rows.length-1].cells[0].firstElementChild.childNodes[1].childNodes[1].innerHTML=sls;
						$("#liangs").html(sls);
					}
				}
				
				function fun(){
					let add=document.getElementsByTagName("button");
					// let del=document.getElementById("shanchu");
					let del=document.getElementsByClassName("shanchu");
					// let tj=document.getElementsByClassName("tj");
					let inpus=document.getElementsByClassName("inpus");
					
					// for(let i=0;i<inpus.length;i++){
					// 	inpus[i].onclick=function(){
					// 		if(.checked){
					// 			money();
					// 		}else{
					// 			money();
					// 		}
							
					// 	}
					// }
					for(let i=0;i<add.length;i++){
						if(i%2==1){
							add[i].onclick=function(){
								if(add[i].previousElementSibling.innerHTML<5){
									adds(this);
								}else{
									alert("此商品购买不能超过5件");
								}
							}	
						}else{
							add[i].onclick=function(){
								if(add[i].nextElementSibling.innerHTML<2){
									alert("此商品购买件数最少为1件");
									
								}else{
									deletes(this);
								}
							}
						}
					}
					for(let i=0;i<del.length;i++){
						del[i].onclick=function(){
							dels(this);
						}
					}
					
				}
				
				
		
				
	})

	
</script>


